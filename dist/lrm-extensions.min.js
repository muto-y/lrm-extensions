/*! lrm-extensions - version 1.0.0 - 2016-12-24 - Copyright 2016 Christian Guyette - Contact: http//www.ouaie.be/ - This  program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or any later version.*/

!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){!function(){"use strict";function a(a,b,c,d){a=a||{},a.color=a.color||"#000000",a.width=a.width||5,a.name=a.name||"",a.clear=a.clear||!1;var e=L.DomUtil.create("div","cyPolylineDialogMainDiv"),f=L.DomUtil.create("div","cyPolylineDialogInputDiv",e),g=L.DomUtil.create("div","cyPolylineDialogColorDiv",f);g.innerHTML="Color:&nbsp;";var h=L.DomUtil.create("input","cyPolylineDialogColorInput",g);h.type="color",h.value=a.color,h.id="cyPolylineDialogColorInput";var i=L.DomUtil.create("div","cyPolylineDialogColorDiv",f);i.innerHTML="Width:&nbsp;";var j=L.DomUtil.create("input","cyPolylineDialogWidthInput",i);j.type="number",j.setAttribute("min",0),j.setAttribute("max",20),j.setAttribute("step",1),j.value=a.width,j.id="cyPolylineDialogWidthInput";var k=L.DomUtil.create("div","cyPolylineDialogNameDiv",f);k.innerHTML="Name:&nbsp;";var l=L.DomUtil.create("input","cyPolylineDialogNameDiv",k);if(l.id="cyPolylineDialogNameInput",l.value=a.name,!d){var m=L.DomUtil.create("div","cyPolylineDialogClearDiv",f);m.innerHTML="Clear route:&nbsp;";var n=L.DomUtil.create("input","cyPolylineDialogClearDiv",m);n.type="checkbox",n.checked=a.clear,n.id="cyPolylineDialogNameInput"}var o=L.DomUtil.create("div","cyPolylineDialogButtonsDiv",e),p=L.DomUtil.create("button","cyPolylineDialogOkButton",o);p.setAttribute("type","button"),p.innerHTML="OK",d?L.DomEvent.on(p,"click",function(){a.color=h.value,a.width=j.value,a.name=l.value,a.clear=!1,b.closePopup(),d.setStyle({color:a.color,weight:a.width}),0<a.name.length?d.bindTooltip(a.name):d.unbindTooltip(),d.LrmExtensionsName=a.name}):L.DomEvent.on(p,"click",function(){a.color=h.value,a.width=j.value,a.name=l.value,a.clear=n.checked,b.closePopup(),c.RouteToLine(a)});var q=L.DomUtil.create("button","cyPolylineDialogCancelButton",o);return q.setAttribute("type","button"),q.innerHTML="Cancel",L.DomEvent.on(q,"click",function(){b.closePopup()}),L.popup({keepInView:!0,closeButton:!0,maxWidth:200,className:"cyPolylineDialog",autoClose:!1}).setContent(e).setLatLng(b.getCenter()).openOn(b),a}function c(b,c,d,e){return new a(b,c,d,e)}"undefined"!=typeof b&&b.exports&&(b.exports=c)}()},{}],2:[function(a,b,c){!function(){"use strict";var c=function(c,d,e){L.DomEvent.stopPropagation(c);var f=L.DomUtil.create("div","PolylineMenu-MainDiv"),g=L.DomUtil.create("button","PolylineMenu-EditPolylineButton",f);g.setAttribute("type","button"),g.innerHTML="Edit";var h;h="undefined"!=typeof b&&b.exports?a("./L.Routing.Extensions.Dialogs"):polylineDialog,L.DomEvent.on(g,"click",function(){d.closePopup();var e={color:c.target.options.color,width:c.target.options.weight,name:c.target.LrmExtensionsName};e="undefined"!=typeof b&&b.exports?a("./L.Routing.Extensions.Dialogs")(e,d,null,c.target):polylineDialog(e,d,null,c.target)});var i=L.DomUtil.create("button","PolylineMenu-DeletePolylineButton",f);i.setAttribute("type","button"),i.innerHTML="Delete",L.DomEvent.on(i,"click",function(){d.closePopup(),e.getRoutePolylines().removeLayer(c.target)});var j=L.DomUtil.create("button","PolylineMenu-CancelPolylineButton",f);j.setAttribute("type","button"),j.innerHTML="Cancel",j.id="CancelPolylineButton",L.DomEvent.on(j,"click",function(){d.closePopup()}),L.popup({keepInView:!0,closeButton:!1,maxWidth:300,className:"PolylineMenu"}).setContent(f).setLatLng(c.latlng).openOn(d),document.getElementById("CancelPolylineButton").focus()};"undefined"!=typeof b&&b.exports&&(b.exports=c)}()},{"./L.Routing.Extensions.Dialogs":1}],3:[function(a,b,c){!function(){"use strict";L.Routing.Extensions=L.Routing.Control.extend({_RoutePolylines:L.layerGroup(),_GpxRoute:null,getTransitMode:function(){return this.options.transitMode},getProvider:function(){return this.options.provider},initialize:function(a){Lrm=this,a.language=a.language||"en",a.transitMode=a.transitMode||"car",a.transitMode=a.transitMode.toLowerCase(),a.provider=a.provider||"osrm",a.provider=a.provider.toLowerCase(),a.providerKeys=a.providerKeys||{},a.providerKeys.GraphHopper=a.providerKeys.GraphHopper||"",a.providerKeys.Mapzen=a.providerKeys.Mapzen||"",a.providerKeys.Mapbox=a.providerKeys.Mapbox||"",0===a.providerKeys.GraphHopper.length&&0===a.providerKeys.Mapzen.length&&0===a.providerKeys.Mapbox.length&&(a.provider="osrm"),-1===["graphhopper","mapzen","mapbox","osrm"].indexOf(a.provider)&&(a.provider="osrm"),-1===["bike","pedestrian","car"].indexOf(a.transitMode)&&(a.transitMode="car"),0===a.providerKeys.GraphHopper.length&&"graphhopper"===a.provider&&(a.provider="osrm"),0===a.providerKeys.Mapzen.length&&"mapzen"===a.provider&&(a.provider="osrm"),0===a.providerKeys.Mapbox.length&&"mapbox"===a.provider&&(a.provider="osrm"),"osrm"===a.provider&&(a.transitMode="car"),L.Util.setOptions(this,a),L.Routing.Control.prototype.initialize.call(this,a)},_createRadioButton:function(a,b,c,d,e){var f=L.DomUtil.create("input","lrm-extensions-Button",a);f.type="radio",f.setAttribute("title",b),f.setAttribute("name",c),f.id=d;var g=L.DomUtil.create("label","lrm-extensions-Label",a);return g.setAttribute("title",b),g.setAttribute("for",d),g.id=e,f},_RoutingButtonsDiv:L.DomUtil.create("form","lrm-extensions-RoutingButtons"),_ServicesButtonsDiv:L.DomUtil.create("form","lrm-extensions-ServiceButtons"),onAdd:function(c){var d,e,f,g=L.Routing.Control.prototype.onAdd.call(this,c);if(0<this.options.providerKeys.GraphHopper.length||0<this.options.providerKeys.Mapzen.length||0<this.options.providerKeys.Mapbox.length){switch(d=this._createRadioButton(this._RoutingButtonsDiv,"Bike","transitmode","lrm-extensions-BikeButton","lrm-extensions-BikeLabel"),e=this._createRadioButton(this._RoutingButtonsDiv,"Pedestrian","transitmode","lrm-extensions-PedestrianButton","lrm-extensions-PedestrianLabel"),f=this._createRadioButton(this._RoutingButtonsDiv,"Car","transitmode","lrm-extensions-CarButton","lrm-extensions-CarLabel"),this.options.transitMode){case"bike":d.checked=!0;break;case"pedestrian":e.checked=!0;break;case"car":f.checked=!0;break;default:f.checked=!0}L.DomEvent.on(d,"click",function(a){switch(Lrm.options.transitMode="bike",Lrm.options.provider){case"graphhopper":Lrm.options.router.options.urlParameters.vehicle="bike";break;case"mapzen":Lrm.options.router.costing="bicycle",Lrm.options.router.options.costing="bicycle";break;case"mapbox":Lrm.options.router.options.profile="mapbox/cycling"}Lrm.route(),Lrm.fire("transitmodechanged")}),L.DomEvent.on(e,"click",function(a){switch(Lrm.options.transitMode="pedestrian",Lrm.options.provider){case"graphhopper":Lrm.options.router.options.urlParameters.vehicle="foot";break;case"mapzen":Lrm.options.router.costing="pedestrian",Lrm.options.router.options.costing="pedestrian";break;case"mapbox":Lrm.options.router.options.profile="mapbox/walking"}Lrm.route(),Lrm.fire("transitmodechanged")}),L.DomEvent.on(f,"click",function(a){switch(Lrm.options.transitMode="car",Lrm.options.provider){case"graphhopper":Lrm.options.router.options.urlParameters.vehicle="car";break;case"mapzen":Lrm.options.router.costing="auto",Lrm.options.router.options.costing="auto";break;case"mapbox":Lrm.options.router.options.profile="mapbox/driving"}Lrm.route(),Lrm.fire("transitmodechanged")})}var h,i,j;switch(0<this.options.providerKeys.GraphHopper.length&&(h=this._createRadioButton(this._RoutingButtonsDiv,"GraphHopper","provider","lrm-extensions-GraphHopperButton","lrm-extensions-GraphHopperLabel"),L.DomEvent.on(h,"click",function(a){Lrm._ProviderChange("graphhopper"),Lrm.fire("providerchanged")})),0<this.options.providerKeys.Mapzen.length&&(i=this._createRadioButton(this._RoutingButtonsDiv,"Mapzen","provider","lrm-extensions-MapzenButton","lrm-extensions-MapzenLabel"),L.DomEvent.on(i,"click",function(a){Lrm._ProviderChange("mapzen"),Lrm.fire("providerchanged")})),0<this.options.providerKeys.Mapbox.length&&(j=this._createRadioButton(this._RoutingButtonsDiv,"Mapbox","provider","lrm-extensions-MapboxButton","lrm-extensions-MapboxLabel"),L.DomEvent.on(j,"click",function(a){Lrm._ProviderChange("mapbox"),Lrm.fire("providerchanged")})),this.options.provider){case"graphhopper":h&&(h.checked=!0);break;case"mapzen":i&&(i.checked=!0);break;case"mapbox":j&&(j.checked=!0)}var k=L.DomUtil.create("a","lrm-extensions-ServicesAnchor",this._ServicesButtonsDiv);k.id="downloadGpx",k.setAttribute("download","lrm-extensions.gpx"),k.innerHTML='<span id="lrm-extensions-GpxButton" class="lrm-extensions-ServicesButton"></span>';var l=L.DomUtil.create("span","lrm-extensions-ServicesButton",this._ServicesButtonsDiv);l.id="lrm-extensions-RouteToLineButton";var m={color:"#ff0000",width:5,clear:!1,name:""};return L.DomEvent.on(l,"click",function(c){Lrm._GpxRoute&&Lrm._GpxRoute.name&&0<Lrm._GpxRoute.name.length?m.name=Lrm._GpxRoute.name:m.name="",m="undefined"!=typeof b&&b.exports?a("./L.Routing.Extensions.Dialogs")(m,Lrm._map,Lrm):polylineDialog(m,Lrm._map,Lrm)}),g.insertBefore(this._RoutingButtonsDiv,g.firstChild),g.insertBefore(this._ServicesButtonsDiv,g.firstChild),this._RoutePolylines.addTo(c),g},RouteToLine:function(c){if(this._GpxRoute&&this._GpxRoute.coordinates&&0<this._GpxRoute.coordinates.length){var d=L.polyline(this._GpxRoute.coordinates,{color:c.color,weight:c.width});0<c.name.length?d.bindTooltip(c.name):d.unbindTooltip(),d.LrmExtensionsName=c.name;var e;e="undefined"!=typeof b&&b.exports?a("./L.Routing.Extensions.PolylineMenu"):polylineMenu,L.DomEvent.on(d,"click",function(a){e(a,this._map,Lrm)}),L.DomEvent.on(d,"contextmenu",function(a){e(a,this._map,Lrm)}),this._RoutePolylines.addLayer(d),c.clear&&this.setWaypoints([])}},addPolyline:function(c,d,e){var f=L.polyline(c,d);0<e.length&&f.bindTooltip(e),f.LrmExtensionsName=e;var g;g="undefined"!=typeof b&&b.exports?a("./L.Routing.Extensions.PolylineMenu"):polylineMenu,L.DomEvent.on(f,"click",function(a){g(a,this._map,Lrm)}),L.DomEvent.on(f,"contextmenu",function(a){g(a,this._map,Lrm)}),this._RoutePolylines.addLayer(f)},getRoutePolylines:function(){return this._RoutePolylines},show:function(){L.Routing.Control.prototype.show.call(this),this._RoutingButtonsDiv.setAttribute("style","display: block"),this._ServicesButtonsDiv.setAttribute("style","display: block")},hide:function(){L.Routing.Control.prototype.hide.call(this),this._RoutingButtonsDiv.setAttribute("style","display: none"),this._ServicesButtonsDiv.setAttribute("style","display: none")},_updateLines:function(a){L.Routing.Control.prototype._updateLines.call(this,a),this._GpxRoute=a.route,this._prepareGpxLink(),this.fire("gpxchanged")},_prepareGpxLink:function(){var a=null;try{var b=new File([this.getGpxString()],{type:"application/xml"});null!==a&&window.URL.revokeObjectURL(a),a=window.URL.createObjectURL(b)}catch(a){}a?document.getElementById("downloadGpx").href=a:document.getElementById("downloadGpx").style.visibility="hidden"},_toXmlString:function(a){return a.replace("&","&amp;").replace("'","&apos;").replace('"',"&quote;").replace(">","&gt;").replace("<","&lt;")},getGpxString:function(a){void 0===a&&(a=a||{}),void 0===a.GpxXmlDeclaration&&(a.GpxXmlDeclaration=!0),void 0===a.GpxDate&&(a.GpxDate=2),void 0===a.GpxWaypoints&&(a.GpxWaypoints=!0),void 0===a.gpxRoute&&(a.gpxRoute=!0),void 0===a.GpxTrack&&(a.GpxTrack=!0);var b,c="\n",d="\n\t",e="\n\t\t",f="\n\t\t\t";switch(a.GpxDate){case 0:b="";break;case 1:b="time='1970-01-01T00:00:00.000Z' ";break;default:b="time='"+(new Date).toISOString()+"' "}var g="";if(a.GpxXmlDeclaration&&(g="<?xml version='1.0'?>"+c),g+="<gpx xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xsi:schemaLocation='http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd' version='1.1' creator='Leaflet-Routing-Gpx'>",this._GpxRoute){var h=0;if(this._GpxRoute.waypoints&&a.GpxWaypoints)for(h=0;h<this._GpxRoute.waypoints.length;h++)g+=d+"<wpt lat='"+this._GpxRoute.waypoints[h].latLng.lat+"' lon='"+this._GpxRoute.waypoints[h].latLng.lng+"' "+b+"name='"+h+"' />";if(this._GpxRoute.coordinates&&0<this._GpxRoute.coordinates.length){if(a.gpxRoute){if(g+=d+"<rte>",this._GpxRoute.instructions&&0<this._GpxRoute.instructions.length)for(h=0;h<this._GpxRoute.instructions.length;h++)g+=e+"<rtept lat='"+(this._GpxRoute.coordinates[this._GpxRoute.instructions[h].index].lat?this._GpxRoute.coordinates[this._GpxRoute.instructions[h].index].lat:this._GpxRoute.coordinates[this._GpxRoute.instructions[h].index][0])+"' lon='"+(this._GpxRoute.coordinates[this._GpxRoute.instructions[h].index].lng?this._GpxRoute.coordinates[this._GpxRoute.instructions[h].index].lng:this._GpxRoute.coordinates[this._GpxRoute.instructions[h].index][1])+"' "+b+"name='"+h+"' desc='"+this._toXmlString(this._formatter.formatInstruction(this._GpxRoute.instructions[h]))+"' />";g+=d+"</rte>"}if(a.GpxTrack){for(g+=d+"<trk>",g+=e+"<trkseg>",h=0;h<this._GpxRoute.coordinates.length;h++)g+=f+"<trkpt lat='"+(this._GpxRoute.coordinates[h].lat?this._GpxRoute.coordinates[h].lat:this._GpxRoute.coordinates[h][0])+"' lon='"+(this._GpxRoute.coordinates[h].lng?this._GpxRoute.coordinates[h].lng:this._GpxRoute.coordinates[h][1])+"' "+b+"name='"+h+"' />";g+=e+"</trkseg>",g+=d+"</trk>"}}}return g+=c+"</gpx>"},getRouteHTMLElement:function(a){a=a||{},a.RouteElement=a.RouteElement||"div",a.RouteHeader=a.RouteHeader||"<h1>Itinéraire:</h1>",a.RouteElementId=a.RouteElementId||"Route",a.RouteSummaryTemplate=a.RouteSummaryTemplate||'<div class="Route-Summary">Distance&nbsp;:&nbsp;{ Distance }&nbsp;-&nbsp;Temps&nbsp;:&nbsp;{ Time }</div>',a.CumDistanceTemplate=a.CumDistanceTemplate||'<div class="Route-CumDistance"> Distance cumulée&nbsp;:&nbsp;environ&nbsp;{ CumDistance }<div>',a.RouteTextInstructionTemplate=a.RouteTextInstructionTemplate||'<div class="Route-TextInstruction">{TextInstruction}</div>',a.RouteNextDistanceTemplate=a.RouteNextDistanceTemplate||'<div class="Route-NextDistanceInstruction">Ensuite, continuez pendant environ {NextDistance}</div>',a.RoutePreInstructionTemplate=a.RoutePreInstructionTemplate||'<div class="Route-PreInstruction">{PreInstruction}</div>',a.RoutePostInstructionTemplate=a.RoutePostInstructionTemplate||'<div class="Route-PostInstruction">{PostInstruction}</div>';var b=document.createElement(a.RouteElement);if(b.id=a.RouteElementId,b.innerHTML=a.RouteHeader,this._GpxRoute&&this._GpxRoute.instructions&&0<this._GpxRoute.instructions.length){var c=document.createElement("div");b.appendChild(c),c.outerHTML=L.Util.template(a.RouteSummaryTemplate,{Distance:this._formatter.formatDistance(this._GpxRoute.summary.totalDistance),Time:this._formatter.formatTime(this._GpxRoute.summary.totalTime)});var d=0,e=0;for(d=0;d<this._GpxRoute.instructions.length;d++){switch(this.options.provider){case"graphhopper":if(this._GpxRoute.instructions[d].text){var f=document.createElement("div");if(b.appendChild(f),f.outerHTML=L.Util.template(a.RouteTextInstructionTemplate,{TextInstruction:""+(d+1)+" - "+this._toXmlString(this._GpxRoute.instructions[d].text)}),0<this._GpxRoute.instructions[d].distance){var g=document.createElement("div");b.appendChild(g),g.outerHTML=L.Util.template(a.RouteNextDistanceTemplate,{NextDistance:this._formatter.formatDistance(Math.round(1e3*this._GpxRoute.instructions[d].distance)/1e3)})}}break;case"mapzen":if(this._GpxRoute.instructions[d].verbal_pre_transition_instruction){var h=document.createElement("div");b.appendChild(h),h.outerHTML=L.Util.template(a.RoutePreInstructionTemplate,{PreInstruction:""+(d+1)+" - "+this._toXmlString(this._GpxRoute.instructions[d].verbal_pre_transition_instruction)})}if(this._GpxRoute.instructions[d].verbal_post_transition_instruction){var i=document.createElement("div");b.appendChild(i),i.outerHTML=L.Util.template(a.RoutePostInstructionTemplate,{PostInstruction:this._toXmlString(this._GpxRoute.instructions[d].verbal_post_transition_instruction)})}break;case"osrm":case"mapbox":var j=document.createElement("div");if(b.appendChild(j),j.outerHTML=L.Util.template(a.RouteTextInstructionTemplate,{TextInstruction:""+(d+1)+" - "+this._formatter.formatInstruction(this._GpxRoute.instructions[d])}),0<this._GpxRoute.instructions[d].distance){var k=document.createElement("div");b.appendChild(k),k.outerHTML=L.Util.template(a.RouteNextDistanceTemplate,{NextDistance:this._formatter.formatDistance(Math.round(1e3*this._GpxRoute.instructions[d].distance)/1e3)})}}if(0<e){var l=document.createElement("div");b.appendChild(l),l.outerHTML=L.Util.template(a.CumDistanceTemplate,{CumDistance:this._formatter.formatDistance(Math.round(1e3*e)/1e3)})}e+=this._GpxRoute.instructions[d].distance}}return b}}),L.Routing.extensions=function(a){return new L.Routing.Extensions(a)},"undefined"!=typeof b&&b.exports&&(b.exports=L.Routing.extensions)}()},{"./L.Routing.Extensions.Dialogs":1,"./L.Routing.Extensions.PolylineMenu":2}]},{},[3]);